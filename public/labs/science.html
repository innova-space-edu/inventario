<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inventario - Laboratorio de Ciencias</title>

  <!-- Estilos originales -->
  <link rel="stylesheet" href="/css/styles.css" />
  <!-- Fondo espacial + glass UI -->
  <link rel="stylesheet" href="/css/app.css" />

  <!-- JS específico de Ciencias -->
  <script defer src="/js/science.js"></script>
</head>

<body data-page="science" class="body-space">
  <!-- Fondo espacial animado -->
  <div class="background space-bg"></div>

  <div class="app-shell">
    <div class="glass-panel">
      <header>
        <h1>Laboratorio de Ciencias</h1>
        <nav>
          <a href="/">Inicio</a>
        </nav>
      </header>

      <!-- =========================
           SECCIÓN: INVENTARIO
      ========================== -->
      <section class="form-section">
        <h2>Agregar / Editar material de laboratorio</h2>

        <form id="scienceForm" enctype="multipart/form-data" method="post">
          <!-- id oculto para modo edición -->
          <input type="hidden" name="id" id="sciId" />

          <label>Código:</label>
          <input type="text" name="codigo" id="sciCode" required />

          <label>Nombre del material:</label>
          <input type="text" name="nombre" id="sciName" required />

          <label>Descripción:</label>
          <textarea name="descripcion" id="sciDescription" required></textarea>

          <label>Categoría:</label>
          <select id="sciCategory" name="categoria" required>
            <option value="instrumento">Instrumento de laboratorio</option>
            <option value="material químico">Material químico</option>
            <option value="material biológico">Material biológico</option>
            <option value="instrumento electrónico">Instrumento electrónico</option>
            <option value="modelo didáctico">Modelo didáctico / maqueta</option>
            <option value="seguridad">Elemento de seguridad</option>
            <option value="otros">Otros</option>
          </select>

          <label>Cantidad:</label>
          <input type="number" name="cantidad" id="sciQuantity" required />

          <label>Fecha de ingreso:</label>
          <input type="date" name="fecha" id="sciDate" required />

          <label>Fotografía:</label>
          <input type="file" id="sciPhoto" name="photo" accept="image/*" />

          <div style="display:flex; gap:.75rem; margin-top:1rem;">
            <button type="submit" id="scienceFormSubmit" class="button">
              Guardar
            </button>
            <button
              type="button"
              id="scienceFormCancelEdit"
              class="button secondary"
              style="display:none;"
            >
              Cancelar edición
            </button>
          </div>
        </form>
      </section>

      <section class="inventory-section">
        <h2>Inventario general de Ciencias</h2>

        <div class="filters-bar">
          <input
            type="text"
            id="scienceSearch"
            placeholder="Buscar por código, nombre, descripción..."
            class="input-search"
          />
        </div>

        <table id="scienceTable">
          <thead>
            <tr>
              <th>ID</th>
              <th>Código</th>
              <th>Nombre</th>
              <th>Descripción</th>
              <th>Categoría</th>
              <th>Cantidad</th>
              <th>Fecha</th>
              <th>Foto</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="scienceTableBody">
            <!-- Elementos cargados dinámicamente -->
          </tbody>
        </table>
      </section>

      <!-- =========================
           SECCIÓN: PRÉSTAMOS
      ========================== -->
      <section class="loans-section">
        <h2>Registrar préstamo</h2>

        <form id="scienceLoanForm">
          <label>Código del material:</label>
          <input type="text" id="sciLoanCodigo" name="codigo" required />

          <!-- Selector de persona (compartido con Biblioteca) -->
          <label>Persona (desde listado):</label>
          <select id="sciLoanPersonSelect" name="personaId">
            <option value="">-- Seleccionar desde lista --</option>
          </select>

          <label>Nombre:</label>
          <input type="text" id="sciLoanNombre" name="nombre" required />

          <label>Curso / Unidad:</label>
          <input type="text" id="sciLoanCurso" name="curso" />

          <label>Tipo de persona:</label>
          <input
            type="text"
            id="sciLoanTipoPersona"
            name="tipoPersona"
            placeholder="estudiante / funcionario"
          />

          <label>Observaciones:</label>
          <input
            type="text"
            id="sciLoanObservaciones"
            name="observaciones"
            placeholder="Opcional"
          />

          <button type="submit" class="button">Registrar préstamo</button>
        </form>

        <!-- Cuadro de devolución rápida por ID -->
        <form id="scienceReturnForm" style="margin-top: 1rem;">
          <h3>Registrar devolución</h3>
          <label>ID del préstamo:</label>
          <input
            type="text"
            id="scienceReturnId"
            name="loanId"
            placeholder="Ej: 17640888254868"
            required
          />
          <button type="submit" class="button">Registrar devolución</button>
        </form>

        <div class="filters-bar" style="margin-top: 1.5rem;">
          <input
            type="text"
            id="scienceLoansSearch"
            placeholder="Buscar préstamo por ID, nombre, código, curso..."
            class="input-search"
          />
        </div>

        <h3>Préstamos</h3>
        <table id="scienceLoansTable">
          <thead>
            <tr>
              <th>ID</th>
              <th>Código</th>
              <th>Nombre</th>
              <th>Curso</th>
              <th>Fecha</th>
              <th>Devuelto</th>
              <th>Devuelto el</th>
              <th>Observaciones</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="scienceLoansTableBody">
            <!-- Carga dinámica JS -->
          </tbody>
        </table>
      </section>

      <!-- =========================
           SECCIÓN: PERSONAS
           (solo lectura, compartidas con Biblioteca)
      ========================== -->
      <section class="people-section">
        <h2>Personas registradas</h2>
        <p class="hint-text">
          Este listado se comparte con Biblioteca. Para agregar o editar
          estudiantes/funcionarios, utiliza el módulo de <b>Biblioteca</b>.
        </p>

        <table id="sciencePeopleTable">
          <thead>
            <tr>
              <th>ID</th>
              <th>Nombre</th>
              <th>Tipo</th>
              <th>Curso / Cargo</th>
            </tr>
          </thead>
          <tbody>
            <!-- Carga dinámica JS -->
          </tbody>
        </table>
      </section>

      <footer>
        <p>© 2025 Innova Space Education - Laboratorio de Ciencias</p>
      </footer>
    </div>
  </div>

  <!-- Scripts generales -->
  <script src="/js/script.js"></script>
  <script src="/js/roleGuard.js"></script>
</body>
</html>
